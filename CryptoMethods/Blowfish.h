#pragma once
#include "CryptoMethodDefines.h"

namespace CryptoMethods {

constexpr size_t c_blowfishblocksize = 8;

// P-array, 18 32-bit subkeys
constexpr uint32_t c_InitP[18] = {
    0x243f6a88ul, 0x85a308d3ul, 0x13198a2eul, 0x03707344ul, 0xa4093822ul,
    0x299f31d0ul, 0x082efa98ul, 0xec4e6c89ul, 0x452821e6ul, 0x38d01377ul,
    0xbe5466cful, 0x34e90c6cul, 0xc0ac29b7ul, 0xc97c50ddul, 0x3f84d5b5ul,
    0xb5470917ul, 0x9216d5d9ul, 0x8979fb1bul };

// Four 32-bit S-boxes with 256 entries each
constexpr uint32_t c_InitS[4][256] = {
    {0xd1310ba6ul, 0x98dfb5acul, 0x2ffd72dbul, 0xd01adfb7ul, 0xb8e1afedul, 0x6a267e96ul,
     0xba7c9045ul, 0xf12c7f99ul, 0x24a19947ul, 0xb3916cf7ul, 0x0801f2e2ul, 0x858efc16ul,
     0x636920d8ul, 0x71574e69ul, 0xa458fea3ul, 0xf4933d7eul, 0x0d95748ful, 0x728eb658ul,
     0x718bcd58ul, 0x82154aeeul, 0x7b54a41dul, 0xc25a59b5ul, 0x9c30d539ul, 0x2af26013ul,
     0xc5d1b023ul, 0x286085f0ul, 0xca417918ul, 0xb8db38eful, 0x8e79dcb0ul, 0x603a180eul,
     0x6c9e0e8bul, 0xb01e8a3eul, 0xd71577c1ul, 0xbd314b27ul, 0x78af2fdaul, 0x55605c60ul,
     0xe65525f3ul, 0xaa55ab94ul, 0x57489862ul, 0x63e81440ul, 0x55ca396aul, 0x2aab10b6ul,
     0xb4cc5c34ul, 0x1141e8ceul, 0xa15486aful, 0x7c72e993ul, 0xb3ee1411ul, 0x636fbc2aul,
     0x2ba9c55dul, 0x741831f6ul, 0xce5c3e16ul, 0x9b87931eul, 0xafd6ba33ul, 0x6c24cf5cul,
     0x7a325381ul, 0x28958677ul, 0x3b8f4898ul, 0x6b4bb9aful, 0xc4bfe81bul, 0x66282193ul,
     0x61d809ccul, 0xfb21a991ul, 0x487cac60ul, 0x5dec8032ul, 0xef845d5dul, 0xe98575b1ul,
     0xdc262302ul, 0xeb651b88ul, 0x23893e81ul, 0xd396acc5ul, 0x0f6d6ff3ul, 0x83f44239ul,
     0x2e0b4482ul, 0xa4842004ul, 0x69c8f04aul, 0x9e1f9b5eul, 0x21c66842ul, 0xf6e96c9aul,
     0x670c9c61ul, 0xabd388f0ul, 0x6a51a0d2ul, 0xd8542f68ul, 0x960fa728ul, 0xab5133a3ul,
     0x6eef0b6cul, 0x137a3be4ul, 0xba3bf050ul, 0x7efb2a98ul, 0xa1f1651dul, 0x39af0176ul,
     0x66ca593eul, 0x82430e88ul, 0x8cee8619ul, 0x456f9fb4ul, 0x7d84a5c3ul, 0x3b8b5ebeul,
     0xe06f75d8ul, 0x85c12073ul, 0x401a449ful, 0x56c16aa6ul, 0x4ed3aa62ul, 0x363f7706ul,
     0x1bfedf72ul, 0x429b023dul, 0x37d0d724ul, 0xd00a1248ul, 0xdb0fead3ul, 0x49f1c09bul,
     0x075372c9ul, 0x80991b7bul, 0x25d479d8ul, 0xf6e8def7ul, 0xe3fe501aul, 0xb6794c3bul,
     0x976ce0bdul, 0x04c006baul, 0xc1a94fb6ul, 0x409f60c4ul, 0x5e5c9ec2ul, 0x196a2463ul,
     0x68fb6faful, 0x3e6c53b5ul, 0x1339b2ebul, 0x3b52ec6ful, 0x6dfc511ful, 0x9b30952cul,
     0xcc814544ul, 0xaf5ebd09ul, 0xbee3d004ul, 0xde334afdul, 0x660f2807ul, 0x192e4bb3ul,
     0xc0cba857ul, 0x45c8740ful, 0xd20b5f39ul, 0xb9d3fbdbul, 0x5579c0bdul, 0x1a60320aul,
     0xd6a100c6ul, 0x402c7279ul, 0x679f25feul, 0xfb1fa3ccul, 0x8ea5e9f8ul, 0xdb3222f8ul,
     0x3c7516dful, 0xfd616b15ul, 0x2f501ec8ul, 0xad0552abul, 0x323db5faul, 0xfd238760ul,
     0x53317b48ul, 0x3e00df82ul, 0x9e5c57bbul, 0xca6f8ca0ul, 0x1a87562eul, 0xdf1769dbul,
     0xd542a8f6ul, 0x287effc3ul, 0xac6732c6ul, 0x8c4f5573ul, 0x695b27b0ul, 0xbbca58c8ul,
     0xe1ffa35dul, 0xb8f011a0ul, 0x10fa3d98ul, 0xfd2183b8ul, 0x4afcb56cul, 0x2dd1d35bul,
     0x9a53e479ul, 0xb6f84565ul, 0xd28e49bcul, 0x4bfb9790ul, 0xe1ddf2daul, 0xa4cb7e33ul,
     0x62fb1341ul, 0xcee4c6e8ul, 0xef20cadaul, 0x36774c01ul, 0xd07e9efeul, 0x2bf11fb4ul,
     0x95dbda4dul, 0xae909198ul, 0xeaad8e71ul, 0x6b93d5a0ul, 0xd08ed1d0ul, 0xafc725e0ul,
     0x8e3c5b2ful, 0x8e7594b7ul, 0x8ff6e2fbul, 0xf2122b64ul, 0x8888b812ul, 0x900df01cul,
     0x4fad5ea0ul, 0x688fc31cul, 0xd1cff191ul, 0xb3a8c1adul, 0x2f2f2218ul, 0xbe0e1777ul,
     0xea752dfeul, 0x8b021fa1ul, 0xe5a0cc0ful, 0xb56f74e8ul, 0x18acf3d6ul, 0xce89e299ul,
     0xb4a84fe0ul, 0xfd13e0b7ul, 0x7cc43b81ul, 0xd2ada8d9ul, 0x165fa266ul, 0x80957705ul,
     0x93cc7314ul, 0x211a1477ul, 0xe6ad2065ul, 0x77b5fa86ul, 0xc75442f5ul, 0xfb9d35cful,
     0xebcdaf0cul, 0x7b3e89a0ul, 0xd6411bd3ul, 0xae1e7e49ul, 0x00250e2dul, 0x2071b35eul,
     0x226800bbul, 0x57b8e0aful, 0x2464369bul, 0xf009b91eul, 0x5563911dul, 0x59dfa6aaul,
     0x78c14389ul, 0xd95a537ful, 0x207d5ba2ul, 0x02e5b9c5ul, 0x83260376ul, 0x6295cfa9ul,
     0x11c81968ul, 0x4e734a41ul, 0xb3472dcaul, 0x7b14a94aul, 0x1b510052ul, 0x9a532915ul,
     0xd60f573ful, 0xbc9bc6e4ul, 0x2b60a476ul, 0x81e67400ul, 0x08ba6fb5ul, 0x571be91ful,
     0xf296ec6bul, 0x2a0dd915ul, 0xb6636521ul, 0xe7b9f9b6ul, 0xff34052eul, 0xc5855664ul,
     0x53b02d5dul, 0xa99f8fa1ul, 0x08ba4799ul, 0x6e85076aul},
    {0x4b7a70e9ul, 0xb5b32944ul, 0xdb75092eul, 0xc4192623ul, 0xad6ea6b0ul, 0x49a7df7dul,
     0x9cee60b8ul, 0x8fedb266ul, 0xecaa8c71ul, 0x699a17fful, 0x5664526cul, 0xc2b19ee1ul,
     0x193602a5ul, 0x75094c29ul, 0xa0591340ul, 0xe4183a3eul, 0x3f54989aul, 0x5b429d65ul,
     0x6b8fe4d6ul, 0x99f73fd6ul, 0xa1d29c07ul, 0xefe830f5ul, 0x4d2d38e6ul, 0xf0255dc1ul,
     0x4cdd2086ul, 0x8470eb26ul, 0x6382e9c6ul, 0x021ecc5eul, 0x09686b3ful, 0x3ebaefc9ul,
     0x3c971814ul, 0x6b6a70a1ul, 0x687f3584ul, 0x52a0e286ul, 0xb79c5305ul, 0xaa500737ul,
     0x3e07841cul, 0x7fdeae5cul, 0x8e7d44ecul, 0x5716f2b8ul, 0xb03ada37ul, 0xf0500c0dul,
     0xf01c1f04ul, 0x0200b3fful, 0xae0cf51aul, 0x3cb574b2ul, 0x25837a58ul, 0xdc0921bdul,
     0xd19113f9ul, 0x7ca92ff6ul, 0x94324773ul, 0x22f54701ul, 0x3ae5e581ul, 0x37c2dadcul,
     0xc8b57634ul, 0x9af3dda7ul, 0xa9446146ul, 0x0fd0030eul, 0xecc8c73eul, 0xa4751e41ul,
     0xe238cd99ul, 0x3bea0e2ful, 0x3280bba1ul, 0x183eb331ul, 0x4e548b38ul, 0x4f6db908ul,
     0x6f420d03ul, 0xf60a04bful, 0x2cb81290ul, 0x24977c79ul, 0x5679b072ul, 0xbcaf89aful,
     0xde9a771ful, 0xd9930810ul, 0xb38bae12ul, 0xdccf3f2eul, 0x5512721ful, 0x2e6b7124ul,
     0x501adde6ul, 0x9f84cd87ul, 0x7a584718ul, 0x7408da17ul, 0xbc9f9abcul, 0xe94b7d8cul,
     0xec7aec3aul, 0xdb851dfaul, 0x63094366ul, 0xc464c3d2ul, 0xef1c1847ul, 0x3215d908ul,
     0xdd433b37ul, 0x24c2ba16ul, 0x12a14d43ul, 0x2a65c451ul, 0x50940002ul, 0x133ae4ddul,
     0x71dff89eul, 0x10314e55ul, 0x81ac77d6ul, 0x5f11199bul, 0x043556f1ul, 0xd7a3c76bul,
     0x3c11183bul, 0x5924a509ul, 0xf28fe6edul, 0x97f1fbfaul, 0x9ebabf2cul, 0x1e153c6eul,
     0x86e34570ul, 0xeae96fb1ul, 0x860e5e0aul, 0x5a3e2ab3ul, 0x771fe71cul, 0x4e3d06faul,
     0x2965dcb9ul, 0x99e71d0ful, 0x803e89d6ul, 0x5266c825ul, 0x2e4cc978ul, 0x9c10b36aul,
     0xc6150ebaul, 0x94e2ea78ul, 0xa5fc3c53ul, 0x1e0a2df4ul, 0xf2f74ea7ul, 0x361d2b3dul,
     0x1939260ful, 0x19c27960ul, 0x5223a708ul, 0xf71312b6ul, 0xebadfe6eul, 0xeac31f66ul,
     0xe3bc4595ul, 0xa67bc883ul, 0xb17f37d1ul, 0x018cff28ul, 0xc332ddeful, 0xbe6c5aa5ul,
     0x65582185ul, 0x68ab9802ul, 0xeecea50ful, 0xdb2f953bul, 0x2aef7dadul, 0x5b6e2f84ul,
     0x1521b628ul, 0x29076170ul, 0xecdd4775ul, 0x619f1510ul, 0x13cca830ul, 0xeb61bd96ul,
     0x0334fe1eul, 0xaa0363cful, 0xb5735c90ul, 0x4c70a239ul, 0xd59e9e0bul, 0xcbaade14ul,
     0xeecc86bcul, 0x60622ca7ul, 0x9cab5cabul, 0xb2f3846eul, 0x648b1eaful, 0x19bdf0caul,
     0xa02369b9ul, 0x655abb50ul, 0x40685a32ul, 0x3c2ab4b3ul, 0x319ee9d5ul, 0xc021b8f7ul,
     0x9b540b19ul, 0x875fa099ul, 0x95f7997eul, 0x623d7da8ul, 0xf837889aul, 0x97e32d77ul,
     0x11ed935ful, 0x16681281ul, 0x0e358829ul, 0xc7e61fd6ul, 0x96dedfa1ul, 0x7858ba99ul,
     0x57f584a5ul, 0x1b227263ul, 0x9b83c3fful, 0x1ac24696ul, 0xcdb30aebul, 0x532e3054ul,
     0x8fd948e4ul, 0x6dbc3128ul, 0x58ebf2eful, 0x34c6ffeaul, 0xfe28ed61ul, 0xee7c3c73ul,
     0x5d4a14d9ul, 0xe864b7e3ul, 0x42105d14ul, 0x203e13e0ul, 0x45eee2b6ul, 0xa3aaabeaul,
     0xdb6c4f15ul, 0xfacb4fd0ul, 0xc742f442ul, 0xef6abbb5ul, 0x654f3b1dul, 0x41cd2105ul,
     0xd81e799eul, 0x86854dc7ul, 0xe44b476aul, 0x3d816250ul, 0xcf62a1f2ul, 0x5b8d2646ul,
     0xfc8883a0ul, 0xc1c7b6a3ul, 0x7f1524c3ul, 0x69cb7492ul, 0x47848a0bul, 0x5692b285ul,
     0x095bbf00ul, 0xad19489dul, 0x1462b174ul, 0x23820e00ul, 0x58428d2aul, 0x0c55f5eaul,
     0x1dadf43eul, 0x233f7061ul, 0x3372f092ul, 0x8d937e41ul, 0xd65fecf1ul, 0x6c223bdbul,
     0x7cde3759ul, 0xcbee7460ul, 0x4085f2a7ul, 0xce77326eul, 0xa6078084ul, 0x19f8509eul,
     0xe8efd855ul, 0x61d99735ul, 0xa969a7aaul, 0xc50c06c2ul, 0x5a04abfcul, 0x800bcadcul,
     0x9e447a2eul, 0xc3453484ul, 0xfdd56705ul, 0x0e1e9ec9ul, 0xdb73dbd3ul, 0x105588cdul,
     0x675fda79ul, 0xe3674340ul, 0xc5c43465ul, 0x713e38d8ul, 0x3d28f89eul, 0xf16dff20ul,
     0x153e21e7ul, 0x8fb03d4aul, 0xe6e39f2bul, 0xdb83adf7ul},
    {0xe93d5a68ul, 0x948140f7ul, 0xf64c261cul, 0x94692934ul, 0x411520f7ul, 0x7602d4f7ul,
     0xbcf46b2eul, 0xd4a20068ul, 0xd4082471ul, 0x3320f46aul, 0x43b7d4b7ul, 0x500061aful,
     0x1e39f62eul, 0x97244546ul, 0x14214f74ul, 0xbf8b8840ul, 0x4d95fc1dul, 0x96b591aful,
     0x70f4ddd3ul, 0x66a02f45ul, 0xbfbc09ecul, 0x03bd9785ul, 0x7fac6dd0ul, 0x31cb8504ul,
     0x96eb27b3ul, 0x55fd3941ul, 0xda2547e6ul, 0xabca0a9aul, 0x28507825ul, 0x530429f4ul,
     0x0a2c86daul, 0xe9b66dfbul, 0x68dc1462ul, 0xd7486900ul, 0x680ec0a4ul, 0x27a18deeul,
     0x4f3ffea2ul, 0xe887ad8cul, 0xb58ce006ul, 0x7af4d6b6ul, 0xaace1e7cul, 0xd3375fecul,
     0xce78a399ul, 0x406b2a42ul, 0x20fe9e35ul, 0xd9f385b9ul, 0xee39d7abul, 0x3b124e8bul,
     0x1dc9faf7ul, 0x4b6d1856ul, 0x26a36631ul, 0xeae397b2ul, 0x3a6efa74ul, 0xdd5b4332ul,
     0x6841e7f7ul, 0xca7820fbul, 0xfb0af54eul, 0xd8feb397ul, 0x454056acul, 0xba489527ul,
     0x55533a3aul, 0x20838d87ul, 0xfe6ba9b7ul, 0xd096954bul, 0x55a867bcul, 0xa1159a58ul,
     0xcca92963ul, 0x99e1db33ul, 0xa62a4a56ul, 0x3f3125f9ul, 0x5ef47e1cul, 0x9029317cul,
     0xfdf8e802ul, 0x04272f70ul, 0x80bb155cul, 0x05282ce3ul, 0x95c11548ul, 0xe4c66d22ul,
     0x48c1133ful, 0xc70f86dcul, 0x07f9c9eeul, 0x41041f0ful, 0x404779a4ul, 0x5d886e17ul,
     0x325f51ebul, 0xd59bc0d1ul, 0xf2bcc18ful, 0x41113564ul, 0x257b7834ul, 0x602a9c60ul,
     0xdff8e8a3ul, 0x1f636c1bul, 0x0e12b4c2ul, 0x02e1329eul, 0xaf664fd1ul, 0xcad18115ul,
     0x6b2395e0ul, 0x333e92e1ul, 0x3b240b62ul, 0xeebeb922ul, 0x85b2a20eul, 0xe6ba0d99ul,
     0xde720c8cul, 0x2da2f728ul, 0xd0127845ul, 0x95b794fdul, 0x647d0862ul, 0xe7ccf5f0ul,
     0x5449a36ful, 0x877d48faul, 0xc39dfd27ul, 0xf33e8d1eul, 0x0a476341ul, 0x992eff74ul,
     0x3a6f6eabul, 0xf4f8fd37ul, 0xa812dc60ul, 0xa1ebddf8ul, 0x991be14cul, 0xdb6e6b0dul,
     0xc67b5510ul, 0x6d672c37ul, 0x2765d43bul, 0xdcd0e804ul, 0xf1290dc7ul, 0xcc00ffa3ul,
     0xb5390f92ul, 0x690fed0bul, 0x667b9ffbul, 0xcedb7d9cul, 0xa091cf0bul, 0xd9155ea3ul,
     0xbb132f88ul, 0x515bad24ul, 0x7b9479bful, 0x763bd6ebul, 0x37392eb3ul, 0xcc115979ul,
     0x8026e297ul, 0xf42e312dul, 0x6842ada7ul, 0xc66a2b3bul, 0x12754cccul, 0x782ef11cul,
     0x6a124237ul, 0xb79251e7ul, 0x06a1bbe6ul, 0x4bfb6350ul, 0x1a6b1018ul, 0x11caedfaul,
     0x3d25bdd8ul, 0xe2e1c3c9ul, 0x44421659ul, 0x0a121386ul, 0xd90cec6eul, 0xd5abea2aul,
     0x64af674eul, 0xda86a85ful, 0xbebfe988ul, 0x64e4c3feul, 0x9dbc8057ul, 0xf0f7c086ul,
     0x60787bf8ul, 0x6003604dul, 0xd1fd8346ul, 0xf6381fb0ul, 0x7745ae04ul, 0xd736fcccul,
     0x83426b33ul, 0xf01eab71ul, 0xb0804187ul, 0x3c005e5ful, 0x77a057beul, 0xbde8ae24ul,
     0x55464299ul, 0xbf582e61ul, 0x4e58f48ful, 0xf2ddfda2ul, 0xf474ef38ul, 0x8789bdc2ul,
     0x5366f9c3ul, 0xc8b38e74ul, 0xb475f255ul, 0x46fcd9b9ul, 0x7aeb2661ul, 0x8b1ddf84ul,
     0x846a0e79ul, 0x915f95e2ul, 0x466e598eul, 0x20b45770ul, 0x8cd55591ul, 0xc902de4cul,
     0xb90bace1ul, 0xbb8205d0ul, 0x11a86248ul, 0x7574a99eul, 0xb77f19b6ul, 0xe0a9dc09ul,
     0x662d09a1ul, 0xc4324633ul, 0xe85a1f02ul, 0x09f0be8cul, 0x4a99a025ul, 0x1d6efe10ul,
     0x1ab93d1dul, 0x0ba5a4dful, 0xa186f20ful, 0x2868f169ul, 0xdcb7da83ul, 0x573906feul,
     0xa1e2ce9bul, 0x4fcd7f52ul, 0x50115e01ul, 0xa70683faul, 0xa002b5c4ul, 0x0de6d027ul,
     0x9af88c27ul, 0x773f8641ul, 0xc3604c06ul, 0x61a806b5ul, 0xf0177a28ul, 0xc0f586e0ul,
     0x006058aaul, 0x30dc7d62ul, 0x11e69ed7ul, 0x2338ea63ul, 0x53c2dd94ul, 0xc2c21634ul,
     0xbbcbee56ul, 0x90bcb6deul, 0xebfc7da1ul, 0xce591d76ul, 0x6f05e409ul, 0x4b7c0188ul,
     0x39720a3dul, 0x7c927c24ul, 0x86e3725ful, 0x724d9db9ul, 0x1ac15bb4ul, 0xd39eb8fcul,
     0xed545578ul, 0x08fca5b5ul, 0xd83d7cd3ul, 0x4dad0fc4ul, 0x1e50ef5eul, 0xb161e6f8ul,
     0xa28514d9ul, 0x6c51133cul, 0x6fd5c7e7ul, 0x56e14ec4ul, 0x362abfceul, 0xddc6c837ul,
     0xd79a3234ul, 0x92638212ul, 0x670efa8eul, 0x406000e0ul},
    {0x3a39ce37ul, 0xd3faf5cful, 0xabc27737ul, 0x5ac52d1bul, 0x5cb0679eul, 0x4fa33742ul,
     0xd3822740ul, 0x99bc9bbeul, 0xd5118e9dul, 0xbf0f7315ul, 0xd62d1c7eul, 0xc700c47bul,
     0xb78c1b6bul, 0x21a19045ul, 0xb26eb1beul, 0x6a366eb4ul, 0x5748ab2ful, 0xbc946e79ul,
     0xc6a376d2ul, 0x6549c2c8ul, 0x530ff8eeul, 0x468dde7dul, 0xd5730a1dul, 0x4cd04dc6ul,
     0x2939bbdbul, 0xa9ba4650ul, 0xac9526e8ul, 0xbe5ee304ul, 0xa1fad5f0ul, 0x6a2d519aul,
     0x63ef8ce2ul, 0x9a86ee22ul, 0xc089c2b8ul, 0x43242ef6ul, 0xa51e03aaul, 0x9cf2d0a4ul,
     0x83c061baul, 0x9be96a4dul, 0x8fe51550ul, 0xba645bd6ul, 0x2826a2f9ul, 0xa73a3ae1ul,
     0x4ba99586ul, 0xef5562e9ul, 0xc72fefd3ul, 0xf752f7daul, 0x3f046f69ul, 0x77fa0a59ul,
     0x80e4a915ul, 0x87b08601ul, 0x9b09e6adul, 0x3b3ee593ul, 0xe990fd5aul, 0x9e34d797ul,
     0x2cf0b7d9ul, 0x022b8b51ul, 0x96d5ac3aul, 0x017da67dul, 0xd1cf3ed6ul, 0x7c7d2d28ul,
     0x1f9f25cful, 0xadf2b89bul, 0x5ad6b472ul, 0x5a88f54cul, 0xe029ac71ul, 0xe019a5e6ul,
     0x47b0acfdul, 0xed93fa9bul, 0xe8d3c48dul, 0x283b57ccul, 0xf8d56629ul, 0x79132e28ul,
     0x785f0191ul, 0xed756055ul, 0xf7960e44ul, 0xe3d35e8cul, 0x15056dd4ul, 0x88f46dbaul,
     0x03a16125ul, 0x0564f0bdul, 0xc3eb9e15ul, 0x3c9057a2ul, 0x97271aecul, 0xa93a072aul,
     0x1b3f6d9bul, 0x1e6321f5ul, 0xf59c66fbul, 0x26dcf319ul, 0x7533d928ul, 0xb155fdf5ul,
     0x03563482ul, 0x8aba3cbbul, 0x28517711ul, 0xc20ad9f8ul, 0xabcc5167ul, 0xccad925ful,
     0x4de81751ul, 0x3830dc8eul, 0x379d5862ul, 0x9320f991ul, 0xea7a90c2ul, 0xfb3e7bceul,
     0x5121ce64ul, 0x774fbe32ul, 0xa8b6e37eul, 0xc3293d46ul, 0x48de5369ul, 0x6413e680ul,
     0xa2ae0810ul, 0xdd6db224ul, 0x69852dfdul, 0x09072166ul, 0xb39a460aul, 0x6445c0ddul,
     0x586cdecful, 0x1c20c8aeul, 0x5bbef7ddul, 0x1b588d40ul, 0xccd2017ful, 0x6bb4e3bbul,
     0xdda26a7eul, 0x3a59ff45ul, 0x3e350a44ul, 0xbcb4cdd5ul, 0x72eacea8ul, 0xfa6484bbul,
     0x8d6612aeul, 0xbf3c6f47ul, 0xd29be463ul, 0x542f5d9eul, 0xaec2771bul, 0xf64e6370ul,
     0x740e0d8dul, 0xe75b1357ul, 0xf8721671ul, 0xaf537d5dul, 0x4040cb08ul, 0x4eb4e2ccul,
     0x34d2466aul, 0x0115af84ul, 0xe1b00428ul, 0x95983a1dul, 0x06b89fb4ul, 0xce6ea048ul,
     0x6f3f3b82ul, 0x3520ab82ul, 0x011a1d4bul, 0x277227f8ul, 0x611560b1ul, 0xe7933fdcul,
     0xbb3a792bul, 0x344525bdul, 0xa08839e1ul, 0x51ce794bul, 0x2f32c9b7ul, 0xa01fbac9ul,
     0xe01cc87eul, 0xbcc7d1f6ul, 0xcf0111c3ul, 0xa1e8aac7ul, 0x1a908749ul, 0xd44fbd9aul,
     0xd0dadecbul, 0xd50ada38ul, 0x0339c32aul, 0xc6913667ul, 0x8df9317cul, 0xe0b12b4ful,
     0xf79e59b7ul, 0x43f5bb3aul, 0xf2d519fful, 0x27d9459cul, 0xbf97222cul, 0x15e6fc2aul,
     0x0f91fc71ul, 0x9b941525ul, 0xfae59361ul, 0xceb69cebul, 0xc2a86459ul, 0x12baa8d1ul,
     0xb6c1075eul, 0xe3056a0cul, 0x10d25065ul, 0xcb03a442ul, 0xe0ec6e0eul, 0x1698db3bul,
     0x4c98a0beul, 0x3278e964ul, 0x9f1f9532ul, 0xe0d392dful, 0xd3a0342bul, 0x8971f21eul,
     0x1b0a7441ul, 0x4ba3348cul, 0xc5be7120ul, 0xc37632d8ul, 0xdf359f8dul, 0x9b992f2eul,
     0xe60b6f47ul, 0x0fe3f11dul, 0xe54cda54ul, 0x1edad891ul, 0xce6279cful, 0xcd3e7e6ful,
     0x1618b166ul, 0xfd2c1d05ul, 0x848fd2c5ul, 0xf6fb2299ul, 0xf523f357ul, 0xa6327623ul,
     0x93a83531ul, 0x56cccd02ul, 0xacf08162ul, 0x5a75ebb5ul, 0x6e163697ul, 0x88d273ccul,
     0xde966292ul, 0x81b949d0ul, 0x4c50901bul, 0x71c65614ul, 0xe6c6c7bdul, 0x327a140aul,
     0x45e1d006ul, 0xc3f27b9aul, 0xc9aa53fdul, 0x62a80f00ul, 0xbb25bfe2ul, 0x35bdd2f6ul,
     0x71126905ul, 0xb2040222ul, 0xb6cbcf7cul, 0xcd769c2bul, 0x53113ec0ul, 0x1640e3d3ul,
     0x38abbd60ul, 0x2547adf0ul, 0xba38209cul, 0xf746ce76ul, 0x77afa1c5ul, 0x20756060ul,
     0x85cbfe4eul, 0x8ae88dd8ul, 0x7aaaf9b0ul, 0x4cf9aa7eul, 0x1948c25cul, 0x02fb8a8cul,
     0x01c36ae4ul, 0xd6ebe1f9ul, 0x90d4f869ul, 0xa65cdea0ul, 0x3f09252dul, 0xc208e69ful,
     0xb74e6132ul, 0xce77e25bul, 0x578fdfe3ul, 0x3ac372e6ul} };

class Blowfish : public CipherBase {
public:
    Blowfish();
    virtual ~Blowfish();

    virtual const enum_crypt_methods CryptMethod() override { return p_method; }
    virtual const size_t BlockSize() override;
    virtual const size_t KeyLength(size_t *min, size_t *max) override;

    virtual bool SetKey(const uint8_t *key, const size_t keylen) override;
    virtual bool Encrypt(const uint8_t *plain, uint8_t *cipher) override;
    virtual bool Decrypt(const uint8_t *cipher, uint8_t *plain) override;

private:
    enum_crypt_methods p_method;
    size_t p_blocksize;

    bool p_haskey;

    uint8_t p_key[128];
    size_t p_keylen;

    uint32_t p_P[18];
    uint32_t p_S[4][256];

    void Encrypt(uint32_t& L, uint32_t& R);
    void Decrypt(uint32_t& L, uint32_t& R);
    inline uint32_t f(uint32_t x) {
        return ((p_S[0][(x >> 24) & 0xff] + p_S[1][(x >> 16) & 0xff]) ^
            p_S[2][(x >> 8) & 0xff]) +
            p_S[3][x & 0xff];
    }
};

}
